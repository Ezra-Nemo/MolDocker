(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{"4qyW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));let i={selected(){this.$store.commit("setFpocketParam",{name:this.id,val:this.selected})}},o={desc(){let e="";return!0!==this.required&&void 0===this.default&&(e=" (Do not change to use default value.)"),this.description+e}};function s(){void 0===this.$store.state.validation[this.id]&&this.$store.commit("setValidationParam",{name:this.id,val:!this.required}),void 0!==this.selected&&this.$store.commit("setFpocketParam",{name:this.id,val:this.default})}function r(){Vue.component("dropdown-input",{data:function(){return{invalidMsg:"This field is required.",action:"Change"}},computed:o,watch:i,template:'\n            <form-group\n                :label="label"\n                :id="\'input-group-\' + id"\n                :style="styl"\n                :description="desc"\n                :formGroupWrapper="formGroupWrapper"\n            >\n\n                <div>\n                    <b-form-select\n                    :id="id"\n                    :name="id"\n                    v-model="selected"\n                    :options="options"></b-form-select>\n                </div>\n            </form-group>\n        ',props:{selected:null,label:String,id:String,description:String,placeholder:String,required:Boolean,styl:String,options:{type:Array,required:!0,validator:e=>!e.find(e=>"object"!=typeof e)},formGroupWrapper:{type:Boolean,default:!0}},mounted:s})}},"6rD0":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("kXk/");let o={fpocketParamsValidate(){return this.$store.state.fpocketParamsValidates},commandlineStr(){if(!1===this.fpocketParamsValidate)return"First fix parameter problems above...";{let e=this.$store.state.fpocketParams;const t=Object.keys(e),n=t.length,i=[];for(let o=0;o<n;o++){const n=t[o],s=e[n];if(!1!==s&&null!=s){let e=[n];"boolean"!=typeof s?e.push(s.toString()):e.push(""),i.push(e)}}i.sort();let o="";const s=i.length;for(let e=0;e<s;e++){const t=i[e],n=t[0],s=t[1];o=o+" --"+n,""!==s&&(o=o+" "+s.toString())}return"/path/to/fpocket --file "+this.$store.state.pdbFileName+o}}},s={downloadPdbFile(e){var t=new Blob([this.$store.state.pdbContents],{type:"text/plain;charset=utf-8"});Object(i.d)(t,this.$store.state.pdbFileName),e.preventDefault(),e.stopPropagation()}};function r(){Vue.component("fpocket-commandline",{data:()=>({}),computed:o,methods:s,template:'\n            <sub-section v-if="fpocketParamsValidate" title="Run Fpocket from the Command Line">\n                <p>\n                    FPocketWeb is convenient but slower than stand-alone Fpocket.\n                    You may wish to <a href="https://github.com/Discngine/fpocket"\n                    target="_blank">download a binary copy</a>\n                    of Fpocket to run from the command line instead.\n                </p>\n                <form-group\n                    id="input-group-commandline"\n                    description="Type this command into the command line (replacing the path) to run command-line Fpocket with your specified parameters."\n                >\n                    <b-form-input\n                        name="commandline"\n                        v-model="commandlineStr"\n                        type="text"\n                        readonly\n                    ></b-form-input>\n\n                    <template v-slot:extraDescription>\n                        Click to download the <a href="" @click="downloadPdbFile($event);">protein</a> PDB file.\n                    </template>\n                </form-group>\n            </sub-section>\n        ',props:{}})}},"80bV":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));function i(){}},GUlH:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("LSjA"),o=n.n(i),s=n("eeig"),r=n.n(s),l=n("SXG0"),a=n.n(l);n("PjkW");let d={selectedPockets(){return this.$store.state.selectedPockets},pocketsRendered(){return this.$store.state.pocketsRendered},rows(){return this.items.length},items(){let e=[];if(this.$store.state.infoFile){const t=window.store.state.pdbFileNameTrimmed;const n=new TextDecoder("utf-8").decode(window.FS.readFile("/"+t+"_out/"+t+"_info.txt")).split("\n\n");for(let t=0;t<n.length;t++){const i=n[t].split("\n");i.length>1&&(e.push({pocket:t+1,Score:i[1].split(":")[1],Druggability:i[2].split(":")[1],"Alpha Spheres":i[3].split(":")[1],"Total SASA":i[4].split(":")[1],"Polar SASA":i[5].split(":")[1],"Apolar SASA":i[6].split(":")[1],Volume:i[7].split(":")[1],"Mean local hydrophobic density":i[8].split(":")[1],"Mean alpha sphere radius":i[9].split(":")[1],"Mean alpha sphere solvent access":i[10].split(":")[1],"Apolar alpha sphere proportion":i[11].split(":")[1],"Hydrophobicity score":i[12].split(":")[1],"Volume score":i[13].split(":")[1],"Polarity score":i[14].split(":")[1],"Charge score":i[15].split(":")[1],"Proportion of polar atoms":i[16].split(":")[1],"Alpha sphere density":i[17].split(":")[1],"Center of mass, alpha sphere max distance":i[18].split(":")[1],Flexibility:i[19].split(":")[1]}),this.colors[t]=this.generateRandomColor(),console.log("Generating color #"+t+1),this.opacities[t+1]=.85)}this.setColorsStoreVar(),this.setOpacity()}return e},fields:()=>[{key:"pocket",label:"Pocket #",sortable:!0},{key:"color",label:"Color",sortable:!1},{},{key:"Score",sortable:!0},{key:"Druggability",sortable:!0},{key:"Alpha Spheres",sortable:!0},{key:"Volume",sortable:!0},{key:"details",label:"Details"}],allRowsSelectedVariant(){return this.selected.length===this.items.length?void 0:"default"},noRowsSelectedVariant(){return 0===this.selected.length?void 0:"default"}},u={selectedPockets:function(e,t){const n=t.filter(t=>!e.includes(t));for(let e=0;e<n.length;e++)this.$refs.infoOutput.unselectRow(n[e]-1);const i=e.filter(e=>!t.includes(e));for(let e=0;e<i.length;e++)this.$refs.infoOutput.selectRow(i[e]-1)},items(){setTimeout(()=>{this.$refs.infoOutput.selectRow(0)},300),this.$store.commit("setVar",{name:"totalPocketsDetected",val:this.items.length}),console.log("Number of pockets detected:"+this.items.length)},selected(e,t){this.$store.commit("setVar",{name:"infoTableOnlyOneLineSelected",val:1===e.length}),e[0]&&this.$store.commit("setVar",{name:"infoTableSelectedLine",val:e[0].pocket});let n=t.filter((function(t){return-1==e.indexOf(t)})),i=[];for(let e=0;e<n.length;e++)i.push(n[e].pocket);this.$store.commit("setVar",{name:"pocketsToRemove",val:i});let o=e.filter((function(e){return-1==t.indexOf(e)}));i=[];for(let e=0;e<o.length;e++)i.push(o[e].pocket);this.$store.commit("setVar",{name:"pocketsToRender",val:i}),i=[];for(let t=0;t<e.length;t++)i.push(e[t].pocket);this.$store.commit("setVar",{name:"pocketsRendered",val:i})},colors(){this.setColorsStoreVar()}},c={onRowSelected(e){this.selected=e},selectAll(){this.$refs.infoOutput.selectAllRows()},clearSelection(){this.$refs.infoOutput.clearSelected()},generateRandomColor(){let e="#";for(let t=0;t<6;t++){e+=(16*Math.random()|0).toString(16)}return e},setColorsStoreVar(){this.$store.commit("setVar",{name:"pocketsColors",val:JSON.stringify(this.colors)})},setOp(e){let t=this.$refs.slider.getValue();Vue.set(this.opacities,e,t),this.setOpacity()},setOpacity(){this.$store.commit("setVar",{name:"pocketsOpacity",val:JSON.stringify(this.opacities)})}};function m(){Vue.component("info-table",{data:function(){return{selected:[],transProps:{name:"flip-list"},colors:{},opacities:{},value:.85,sliderMin:0,sliderMax:1,sliderInterval:.01,perPage:0,currentPage:1}},components:{"v-input-colorpicker":r.a,VueSlider:a.a},computed:d,template:o.a,props:{},methods:c,watch:u})}},LqqB:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));let i={classToUse(){let e=[this.cls];return!0===this.small&&e.push("download-button float-right ml-1"),e.join(" ")},sizeToUse(){return!0===this.small?"sm":""}};function o(){Vue.component("form-button",{data:function(){return{}},computed:i,template:'\n            <b-button :pill="small" :size="sizeToUse" :class="classToUse" :variant="variant"><slot></slot></b-button>\n        ',props:{variant:String,cls:String,small:{type:Boolean,default:!1}}})}},PzdQ:function(e,t,n){"use strict";let i;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"e",(function(){return h}));let o="OUTPUTOUTPUT";function s(){return n.e(0).then(n.t.bind(null,"oAJy",7)).then(e=>(i=e,Promise.resolve()))}function r(e){return s().then(()=>i.keys()).then(t=>(t=t.filter(t=>t.startsWith(e+"-::-:-")),Promise.resolve(t)))}function l(e){return s().then(()=>r(e)).then(e=>{let t=e.map(e=>i.removeItem(e));return Promise.all(t)})}function a(e,t){return s().then(()=>l(e)).then(()=>{let n=Object.keys(t).map(n=>i.setItem(e+"-::-:-"+n,t[n]));return Promise.all(n)})}function d(e){let t=e.map(e=>r(e));return Promise.all(t).then(e=>Promise.resolve(e))}function u(e){return d(e).then(e=>{let t=e.map(e=>e.length);if(0===t.reduce((e,t)=>e+t))return Promise.resolve(0);for(let e of t)if(0===e)return Promise.resolve(0);return Promise.resolve(Math.max(...t))})}function c(e){let t=e.map(e=>i.getItem(e));return Promise.all(t)}function m(e){return s().then(()=>u(e)).then(t=>{let n;switch(t){case 0:let t=e.map(e=>({filename:"",mol:void 0}));return Promise.resolve(t);case 1:n=!0;break;default:n=!1}return d(e).then(t=>{let o=t.map(e=>({num:e.length,firstKey:e[0]})),s=o.map(e=>e.firstKey);return c(s).then(t=>{s=s.map(e=>e.split("-::-:-")[1]);let r=t.map((e,t)=>({filename:s[t],mol:e})),a=[];return n?e.forEach(e=>l(e)):o.forEach(e=>{e.num>1&&a.push(i.removeItem(e.firstKey))}),Promise.all(a).then(()=>Promise.resolve(r))})})})}function p(e,t="output.zip"){(function(e){let t=[n.e(0).then(n.t.bind(null,"xOOu",7)).then(e=>Promise.resolve(e.default)),n.e(0).then(n.t.bind(null,"Iab2",7)).then(e=>Promise.resolve(e))];return e&&(t=[...t,...e]),Promise.all(t)})().then(n=>{let[i,o]=n;var s=new i;for(let t in e){let n=e[t],i=n;if("string"==typeof i)s.file(t,i);else for(let e in n){let i=n[e];s.folder(t).file(e,i)}}return s.generateAsync({type:"blob"}).then((function(e){o.saveAs(e,t)}))})}function f(e="output.zip"){return s().then(()=>r(o)).then(t=>t.length>0?c(t).then(n=>{let i={};return t.forEach((e,t)=>{let[o,s]=e.split("-::-:-").slice(1);""!==o?(i[o]=i[o]?i[o]:{},i[o][s]=n[t]):i[s]=n[t]}),p(i,e)}):Promise.resolve()).then(()=>i.clear())}function h(e,t,n=""){if("string"!=typeof t)return void alert("ERROR: Output content saved to LocalForage needs to be a string!");let r=[o,n,e].join("-::-:-");return s().then(()=>i.setItem(r,t))}},WPMz:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n("kXk/");let o={fpocketParamsValidate(){return this.$store.state.fpocketParamsValidates},cfgStr(){if(!this.displayConfig)return"Wrong pocket selection!";if(this.$store.state.infoFile){const e=new TextDecoder("utf-8").decode(window.FS.readFile("/"+window.store.state.pdbFileNameTrimmed+"_out/pockets/pocket"+window.store.state.infoTableSelectedLine+"_vert.pqr")),t=/(?:ATOM)(.*)/g;let n=0,i=0,o=0,s=[],r=0;if(e){let l=e.split("\n");for(let e=0;e<l.length;e++){const r=t.exec(l[e]);if(r){const e=r[1].replace(/\s+/g," ").trim().split(" "),t=Number(e[4]),l=Number(e[5]),a=Number(e[6]);s.push([t,l,a]),n+=t,i+=l,o+=a}}n/=l.length,i/=l.length,o/=l.length;for(let e=0;e<s.length;e++)this.distanceVector(n,s[e][0],i,s[e][1],o,s[e][2])>r&&(r=this.distanceVector(n,s[e][0],i,s[e][1],o,s[e][2]));console.log("rad = "+r),console.log("x_av = ",n,"y_av = ",i,"z_av = "+o)}let l='# The master WEST configuration file for a simulation.\n      # vi: set filetype=yaml :\n      ---\n      west: \n        system:\n          driver: adaptive.System\n          module_path: $WEST_SIM_ROOT/adaptive_binning/\n        drivers:\n          sim_manager: manager.WESimManager\n          module_path: $WEST_SIM_ROOT/adaptive_binning/\n          we_driver: driver.WEDriver\n        propagation:\n          max_total_iterations: 30\n          max_run_wallclock:    72:00:00\n          propagator:           executable\n          gen_istates:          true\n        data:\n          west_data_file: west.h5\n          datasets:\n            - name:        pcoord\n              scaleoffset: 4\n            - name:        pvol\n              dtype:       float32\n              scaleoffset: 3\n          data_refs:\n            segment:       $WEST_SIM_ROOT/traj_segs/{segment.n_iter:06d}/{segment.seg_id:06d}\n            basis_state:   $WEST_SIM_ROOT/bstates/{basis_state.auxref}\n            initial_state: $WEST_SIM_ROOT/istates/{initial_state.iter_created}/{initial_state.state_id}\n        plugins:\n        executable:\n          environ:\n            PROPAGATION_DEBUG: 1\n          datasets:\n            - name:    pvol\n            - name:    rog\n            - name:    bb\n            #- name:    fop\n            #  loader:  aux_functions.coord_loader\n            # enabled: true\n          propagator:\n            executable: $WEST_SIM_ROOT/westpa_scripts/runseg.sh\n            stdout:     $WEST_SIM_ROOT/seg_logs/{segment.n_iter:06d}-{segment.seg_id:06d}.log\n            stderr:     $WEST_SIM_ROOT/job_logs/runseg.log\n            stdin:      null\n            cwd:        null\n            environ:\n              SEG_DEBUG: 1\n          get_pcoord:\n            executable: $WEST_SIM_ROOT/westpa_scripts/get_pcoord.sh\n            stdout:     /dev/null \n            stderr:     $WEST_SIM_ROOT/job_logs/get_pcoord.log\n          gen_istate:\n            executable: $WEST_SIM_ROOT/westpa_scripts/gen_istate.sh\n            stdout:     /dev/null \n            stderr:     $WEST_SIM_ROOT/job_logs/gen_istate.log\n          post_iteration:\n            enabled:    true\n            executable: $WEST_SIM_ROOT/westpa_scripts/post_iter.sh\n            stderr:     $WEST_SIM_ROOT/job_logs/post_iter.log\n          pre_iteration:\n            enabled:    false\n            executable: $WEST_SIM_ROOT/westpa_scripts/pre_iter.sh\n            stderr:     $WEST_SIM_ROOT/job_logs/pre_iter.log\n      subpex:\n        # location of important files, some of them will be created by some scripts\n        selection_file: /PATH/TO/SELECTION/FILE/selection_string.txt\n        topology: /PATH/TO/TOPOLOGY/FILE/topology_file\n        west_home: /PATH/TO/WEST/SIMULATION/DIRECTORY\n        reference: /PATH/TO/REFERENCE/FILE/REFERENCE.pdb\n        reference_fop: /PATH/TO/REFERENCE/FOP/FILE/fop_ref.xyz\n        # progress coordinates to calculate ("jd" for Jaccard distance, "prmsd" for pocket heavy atoms RMSD, and/or bb for backbone RMSD, composite for the composite RMSD)\n        pcoord:\n          - composite\n        # filetype for the fop.\n        fop_filetype: xyz\n        # Center of the pocket\n        center: [';return l+=n.toFixed(1)+", "+i.toFixed(1)+", "+o.toFixed(1)+"]\n      # Radius of the pocket to consider\n  radius: "+r.toFixed(1)+'\n  # resolution for the FOP points.\n  resolution: 0.5\n  # auxiliary data to calculate. Make sure it is also on the west.cfg file.\n  auxdata:\n    - prmsd\n    - pvol\n    - bb\n    - rog_pocket\n    - jd\n  # Number of point to calculate per trajectory segment. If -1, it will calculate all.\n  calculated_points: -1\n  # Clustering analysis settings\n  clustering:\n    clustering_engine: "cpptraj" # cpptraj or MDAnalysis (At the momemnt only cpptraj is implemented)\n    number_clusters: 25\n    max_number_clusters_generation_bin: 25\n    min_number_clusters_generation_bin: 3\n    clustering_region: "pocket" # pocket or backbone\n    cluster_generation: true # cant\'t be true at the same time as cluster_bin\n    cluster_bin: false\n    bins:\n      PROG_COORDINATE_CHOSEN: [ BIN, BOUDARIES, "inf" ]\n      PROG_COORDINATE_CHOSEN: [ BIN, BOUDARIES, "inf" ]\n    method: hierarchical\n  # plotting settings\n  plotting:\n    num_walkers: true # plot number of walkers per iteration plot. Useful when NOT using adaptive binning',l}},displayConfig(){return this.$store.state.infoTableOnlyOneLineSelected}},s={downloadFile(e,t){var n=new Blob([this.$store.state[t+"Contents"]],{type:"text/plain;charset=utf-8"});Object(i.d)(n,this.$store.state[t+"FileName"]),e.preventDefault(),e.stopPropagation()},subpexConfigDownload(){var e=new Blob([this.cfgStr],{type:"text/plain;charset=utf-8"});Object(i.d)(e,"west.cfg")},distanceVector:(e,t,n,i,o,s)=>Math.sqrt((e-i)*(e-i)+(t-o)*(t-o)+(n-s)*(n-s))};function r(){Vue.component("fpocket-subpex",{data:()=>({re:new RegExp("(?=ATOM)(.*)")}),computed:o,methods:s,template:'\n            <sub-section v-if="fpocketParamsValidate" title="Run Subpex Using the Detected Pockets">\n                <p>\n                Copy or download a <a href="https://git.durrantlab.pitt.edu/erh91/SubPEx-Erich" target="_blank">SubPex</a> config file.\n                </p>\n                <form-group\n                    id="input-group-commandline"\n                    description="Use this template to run SubPex with the FpocketWeb-detected pockets. Be sure to replace the paths and make other necessary adjustments to the template file."\n                >\n                    <b-form-textarea\n                        v-model="cfgStr"\n                        v-if="displayConfig"\n                        rows="3"\n                        max-rows="6" \n                        style="resize: vertical; white-space: pre;" \n                        class="text-monospace" size="sm"\n                    ></b-form-textarea>\n                    <p v-else>Select one and only one line in <a href="#infoTable">the table above</a> to generate the config file.</p>\n                    <form-button :small="true" @click.native="subpexConfigDownload">Download</form-button>\n                </form-group>\n            </sub-section>\n        ',props:{}})}},Wcx6:function(e,t,n){"use strict";function i(){Vue.component("triple-numeric-input",{data:function(){return{}},computed:{},template:'\n            <form-group\n                :label="label"\n                :id="\'input-group-\' + id1 + \'-\' + id2 + \'-\' + id3"\n                :style="styl"\n                :description="description"\n                v-if="!hide"\n            >\n                <div class="bv-example-row container-fluid">\n                    <b-row>\n                        <b-col style="padding-left: 0;">\n                            <numeric-input\n                                :id="id1"\n                                description=""\n                                placeholder="Missing X value..."\n                                required\n                                :formGroupWrapper="false"\n                                :min="min"\n                            ></numeric-input>\n                        </b-col>\n\n                        <b-col style="">\n                            <numeric-input\n                                :id="id2"\n                                description=""\n                                placeholder="Missing Y value..."\n                                required\n                                :formGroupWrapper="false"\n                                :min="min"\n                            ></numeric-input>\n                        </b-col>\n\n                        <b-col style="padding-right: 0;">\n                            <numeric-input\n                                :id="id3"\n                                description=""\n                                placeholder="Missing Z value..."\n                                required\n                                :formGroupWrapper="false"\n                                :min="min"\n                            ></numeric-input>\n                        </b-col>\n                    </b-row>\n                </div>\n\n            </form-group>\n        ',props:{hide:Boolean,label:String,id1:String,id2:String,id3:String,styl:String,description:String,min:{type:Number,default:void 0}},methods:{}})}n.d(t,"a",(function(){return i}))},Y3sP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));let i={val:{get(){return this.$store.state.fpocketParams[this.id]},set(e){this.$store.commit("setFpocketParam",{name:this.id,val:e})}},desc(){return this.description+(!0!==this.required?" (Leave blank to use default value.)":"")}};function o(){Vue.component("check-box",{data:function(){return{}},computed:i,template:'\n            <b-form-checkbox\n                :id="id"\n                v-model="val"\n                :name="id"\n                :value="true"\n                :unchecked-value="false"\n            >\n                {{label}}\n            </b-form-checkbox>\n        ',props:{label:String,id:String}})}},Y6e5:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));let i={hasLabel(){return""!==this.label&&void 0!==this.label},labelCols(){return!0===this.hasLabel&&!0===this.labelToLeft?3:0},labelColsLg(){return!0===this.hasLabel&&!0===this.labelToLeft?2:0}};function o(){Vue.component("form-group",{data:function(){return{}},computed:i,template:'\n            <span>\n                <b-form-group\n                    v-if="formGroupWrapper"\n                    :label-cols="labelCols" :label-cols-lg="labelColsLg"\n                    :label="label"\n                    :label-for="id"\n                    :id="\'input-group-\' + id"\n                    :style="styl"\n                >\n                    <slot></slot>\n                    <small\n                        tabindex="-1"\n                        :id="\'input-group-input-group-\' + id + \'__BV_description_\'"\n                        class="form-text text-muted" style="display:inline;"\n                        v-html="description">\n                    </small>\n                    <small class="form-text text-muted" style="display:inline;">\n                        <slot name="extraDescription"></slot>\n                    </small>\n                </b-form-group>\n                <div v-else>\n                    <slot></slot>\n                </div>\n            </span>\n        ',props:{label:String,id:String,styl:String,description:String,formGroupWrapper:{type:Boolean,default:!0},labelToLeft:{type:Boolean,default:!0}},methods:{}})}},dKCA:function(e,t,n){"use strict";n.d(t,"a",(function(){return te}));const i=new Set(["ALA","ARG","ASN","ASP","ASH","ASX","CYS","CYM","CYX","GLN","GLU","GLH","GLX","GLY","HIS","HID","HIE","HIP","ILE","LEU","LYS","LYN","MET","MSE","PHE","PRO","SER","THR","TRP","TYR","VAL"]);class o{constructor(){this.atoms=[]}addAtom(e){this.atoms.push(e)}clone(){let e=new o;return e.atoms=JSON.parse(JSON.stringify(this.atoms)),e}partition(e){let t=new o,n=new o;for(let i of this.atoms)e.resnames&&-1===e.resnames.indexOf(i.resn)||e.resids&&-1===e.resids.indexOf(i.resi)||e.chains&&-1===e.chains.indexOf(i.chain)||e.atomNames&&-1===e.atomNames.indexOf(i.atom)||e.elems&&-1===e.elems.indexOf(i.elem)?n.addAtom(i):t.addAtom(i);return[t,n]}getChains(){let e=new Set([]);for(let t of this.atoms)-1===["",void 0].indexOf(t.chain)&&e.add(t.chain);return Array.from(e)}isProtein(e){return i.has(e.resn)}addNonProteinAtomsToMol(e){e.startNewFrame();for(let t of this.atoms)this.isProtein(t)||e.addAtomToCurrentFrame(t)}getCoords(){return this.atoms.filter(e=>!e.nonAtomLine).map(e=>[e.x,e.y,e.z])}getElements(){return this.atoms.filter(e=>!e.nonAtomLine).map(e=>e.elem)}hasHydrogens(){for(let e of this.atoms)if("H"===e.elem)return!0;return!1}hasNonAtomLine(){for(let e of this.atoms)if(e.nonAtomLine)return!0;return!1}numAtoms(){return this.atoms.filter(e=>!e.nonAtomLine).length}strideAtoms(e){let t=0,n=this.atoms.length,i=[];for(;t<n;)i.push(this.atoms[Math.floor(t)]),t+=e;this.atoms=i}keepOnlyProtein(){let e=new o;return e.atoms=this.atoms.filter(e=>this.isProtein(e)),e}updateCoords(e){this.hasNonAtomLine()&&console.log("Can't set coordinates because frame contains non-atom lines!");for(let t in e){let n=e[t],[i,o,s]=n;this.atoms[t].x=i,this.atoms[t].y=o,this.atoms[t].z=s}}removeAltLocs(){let e=new Set([]);this.atoms=this.atoms.filter(t=>{if(" "===t.altLoc)return!0;let n=t.resn;return n+=":"+t.resi,n+=":"+t.chain,n+=":"+t.atom,!e.has(n)&&(e.add(n),!0)})}}const s=new Set(["LI","NA","MG","AL","CL","CA","MN","FE","CO","CU","ZN","AS","BR","MO","RH","AG","AU","PB","BI","NI","SE"]);class r extends class{constructor(e,t){this.frames=[],void 0!==e&&("string"==typeof e?this.load(e,t):this.loadFromRawData(e))}loadFromRawData(e){if(e.frames){for(let t of e.frames){this.startNewFrame();for(let e of t.atoms)this.addAtomToCurrentFrame(e)}delete e.frames}for(let t in e)this[t]=e[t]}frameToMol(e){let t=this.newMolOfThisType();return t.frames=[this.frames[e].clone()],t}startNewFrame(){this.frames.push(new o)}newMolOfThisType(){return new this.constructor(void 0)}clone(){let e=this.newMolOfThisType();return e.frames=this.frames.map(e=>e.clone()),e}addAtomToCurrentFrame(e){this.frames[this.frames.length-1].addAtom(e)}partitionBySelection(e){let t=this.newMolOfThisType(),n=this.newMolOfThisType();for(let i of this.frames){let[o,s]=i.partition(e);t.frames.push(o),n.frames.push(s)}return[t,n]}deleteSelection(e){let[t,n]=this.partitionBySelection(e);return n}keepSelection(e){let[t,n]=this.partitionBySelection(e);return t}keepOnlyProtein(){let e=this.clone();return e.frames=e.frames.map(e=>e.keepOnlyProtein()),e}getNonProteinMol(){let e=this.newMolOfThisType();for(let t of this.frames)t.addNonProteinAtomsToMol(e);return e.frames=e.frames.filter(e=>e.atoms.length>0),e}getChains(){let e=new Set([]);for(let t of this.frames)for(let n of t.getChains())e.add(n);let t=Array.from(e);return t.sort(),t}getCoords(){return this.frames.map(e=>e.getCoords())}getElements(){return this.frames.map(e=>e.getElements())}hasHydrogens(e=!0){for(let t of this.frames){if(t.hasHydrogens())return!0;if(e)break}return!1}numAtomsAcrossAllFrames(){let e=0;for(let t of this.frames)e+=t.numAtoms();return e}numAtoms(e=0){return this.frames[e]?this.frames[e].numAtoms():0}pruneAtoms(e){let t=this.clone();if(this.numAtomsAcrossAllFrames()<e.targetNumAtoms)return t;if(e.keepOnlyFirstFrame&&(t.frames=[t.frames[0]]),this.numAtomsAcrossAllFrames()<e.targetNumAtoms)return t;if(e.keepOnlyProtein&&(t=t.keepOnlyProtein()),this.numAtomsAcrossAllFrames()<e.targetNumAtoms)return t;if(e.removeHydrogens&&(t=t.deleteSelection({elems:["H"]})),this.numAtomsAcrossAllFrames()<e.targetNumAtoms)return t;if(e.removeSidechains&&(t=t.keepSelection({atomNames:["C","N","CA","O"]})),this.numAtomsAcrossAllFrames()<e.targetNumAtoms)return t;let n=this.numAtomsAcrossAllFrames()/e.targetNumAtoms;for(let e of this.frames)e.strideAtoms(n);return t}padStr(e,t,n=!1){if(e.length>t)return e;if(n){for(;e.length<t;)e+=" ";return e}for(;e.length<t;)e=" "+e;return e}scaleFrames(e){let t=this.frames.length;e!==t&&console.log(`WARNING: You have requested ${e} output frame(s), but your PDB file has ${t} frame(s). I will duplicate or stride the PDB frames to produce your requested ${e} output frame(s).\n`);let n=[];for(let i=0;i<e;i++){let o=Math.round((t-1)*i/(e-1));isNaN(o)&&(o=0),n.push(this.frames[o].clone())}let i=this.newMolOfThisType();return i.frames=n,i}updateCoords(e,t){this.frames[e].updateCoords(t)}removeAltLocsCurrentFrame(){this.frames[this.frames.length-1].removeAltLocs()}}{constructor(e,t=!0,n=!0){super(e,{mseToMet:t,removeAltLocs:n})}load(e,t){let n=t.mseToMet,i=t.removeAltLocs,o=e.split(/^(MODEL\s+?\d+?\s+?|^ENDMDL\s+?)/gm);for(let e of o){let t=e.split("\n");if(t=t.filter(e=>"ATOM"===e.slice(0,4)||"HETATM"===e.slice(0,6)||"ROOT"===e.slice(0,4)||"BRANCH"===e.slice(0,6)||"TORSDOF"===e.slice(0,7)),0!==t.length){this.startNewFrame(),n&&(t=this.mseToMet(t));for(let e of t)this.addAtomToCurrentFrame(this.parsePDBLine(e));i&&this.removeAltLocsCurrentFrame()}}}toText(){let e="";for(let t in this.frames)e+="MODEL "+this.padStr((parseInt(t)+1).toString(),8)+"\n",e+=this.frameToText(parseInt(t)),e+="ENDMDL\n";return e}frameToText(e){let t="";for(let n of this.frames[e].atoms){if(void 0!==n.nonAtomLine){t+=n.nonAtomLine+"\n";continue}let e;switch(t+=n.hetflag?"HETATM":"ATOM  ",t+=this.padStr(n.serial,5),n.atom.length){case 1:e="  "+n.atom+"  ";break;case 2:e="  "+n.atom+" ";break;case 3:e="  "+n.atom;break;default:e=" "+n.atom}n.elem&&n.elem.replace(/[^A-Za-z]/gm,"").length>1&&" "===e.substring(0,1)&&(e=e.substring(1)+" "),t+=e,t+=n.altLoc,t+=this.padStr(n.resn,3),t+=this.padStr(n.chain,2),t+=this.padStr(n.resi,4),t+=this.padStr(n.x.toFixed(3),12),t+=this.padStr(n.y.toFixed(3),8),t+=this.padStr(n.z.toFixed(3),8),t+=this.padStr(n.elem,24),t+="\n"}return t=t.replace(/^END\W*$/gm,""),t=t.replace(/\n\n/gm,"\n"),t}parsePDBLine(e){let t=e.substring(0,6);if(-1===["HETATM","ATOM  "].indexOf(t))return{nonAtomLine:e};let n=e.substring(6,11).trim(),i=e.substring(12,16).trim(),o=e.substring(16,17),s=e.substring(17,20).trim(),r=e.substring(21,22).trim(),l=e.substring(22,26).trim(),a=parseFloat(e.substring(30,38)),d=parseFloat(e.substring(38,46)),u=parseFloat(e.substring(46,54)),c=e.length,m=e.substring(c-4).trim();return""===m&&(m=this.elementFromAtomName(e.substring(12,16).trim())),{resn:s,x:a,y:d,z:u,elem:m,chain:r,resi:l,atom:i,hetflag:"HETATM"===t,serial:n,altLoc:o}}elementFromAtomName(e){return e=(e=e.replace(/[0-9]/g,"")).substring(0,2).toUpperCase(),s.has(e)?e:e.substring(0,1)}mseToMet(e){return e.map(e=>("MSE"===e.substring(17,20)&&(e=e.replace(/SE   MSE/g," SD  MET").replace(/MSE/g,"MET").replace(/ SE /g,"  S ").replace(/^HETATM/g,"ATOM  ")),e))}}function l(e,t,n=!0,i=!0){switch(u(d(e),["pdb","pdbqt","ent","brk"])){case"pdb":case"pdbqt":case"ent":case"brk":default:return new r(t,n,i)}}function a(e){return e.toLowerCase().split(/,/g).map(e=>e.replace(/ /g,"").replace(/\./,""))}function d(e,t=!0){if(void 0===e)return"";let n=e.toLowerCase().split(/\./g),i=n[n.length-1];if(t)for(let e=n.length-2;e>0;e--){let t=n[e];if(t.length>4)break;i=t+"."+i}return i}function u(e,t){"."===e.substring(0,1)&&(e=e.substring(1));let n=e.split(/\./g);if(void 0===t)return n.pop().toLowerCase();let i=t.map(e=>e.toLowerCase());if("txt"===n[n.length-1]){if(-1!==i.indexOf("txt"))return"txt";n.pop()}let o=n.pop(),s=i.indexOf(o);return-1!==s?t[s]:void 0}function c(e,t){let n=e.toUpperCase();return"HTTP://"!==n.slice(0,7)&&"HTTPS://"!==n.slice(0,8)?(t.onError({title:"Bad URL",body:"The URL should start with http:// or https://."}),Promise.resolve(!1)):new Promise((n,i)=>{fetch(e).then(i=>{if(i.ok)return i.text();t.onError({title:"Bad URL",body:`Could not load the URL ${e}. Status `+i.status.toString()+": "+i.statusText}),n(!1)}).then(i=>{let o=e.split("/").pop(),s=[{filename:o,mol:l(o,i)}],r=t.onFilesLoaded(s);n(r)}).catch(i=>{m(i,e,t,n)})})}function m(e,t,n,i=(e=>{})){n.onError({title:"Bad URL",body:`Could not load the URL ${t}: `+e.message}),i(!1)}function p(e){document.head.appendChild(Object.assign(document.createElement("style"),{textContent:e}))}function f(e){var t=e.toLowerCase().replace(/[^a-z0-9]+/g,"-");return t=t.replace(/\-\-/g,"-")}let h={hasLabel(){return""!==this.label&&void 0!==this.label},labelCols:()=>0};var g={multipleFiles:{type:Boolean,default:!1},saveMultipleFilesToDatabase:{type:Boolean,default:!1}},b={id:{type:String,required:!1},required:{type:Boolean,default:!0},accept:{type:String,default:""},convert:{type:String,default:""},valid:{type:Boolean,default:!0}},v={allowAtomExtract:{type:Boolean,default:!1},allowAtomDelete:{type:Boolean,default:!0}},y={trigger:{type:Boolean,default:!1,required:!0},countDownSeconds:{type:Number,default:5},molLoaderIds:{type:Array,required:!0},outputZipFilename:{type:String,default:"output.zip"}},S=n("PzdQ");let x={};function A(){Object(S.c)(this.molLoaderIds).then(e=>{this.numItemsInQueue=e,0===e?Object(S.a)(this.outputZipFilename):this.active=!0})}let F={val:{get(){return this.files},set(e){if(null===e)return;void 0===e.map&&(e=[e]);let t=e.map(e=>{return t=e,new Promise((e,n)=>{var i=new FileReader;i.onload=()=>{var t=new Uint8Array(i.result);e(new TextDecoder("utf-8").decode(t))},i.readAsArrayBuffer(t)});var t});Promise.all(t).then(t=>{let n=e.map((n,i)=>({filename:e[i].name,mol:l(e[i].name,t[i])}));!1===this.onFilesLoaded(n)&&(this.files=null)})}}},T={formatFileNames(){return this.placeholder}};function O(){p(".form-file-text { color: #878e95 }")}function w(e){let t=e.map(e=>d(e.filename)),n=a(this.accept),i=a(this.convert),o={convertNeeded:[],invalidFiles:[],acceptablefiles:[]};const s=t.length;for(let r=0;r<s;r++){const s=t[r];let l=e[r];u(s,i)?o.convertNeeded.push(l):void 0===u(s,n)?o.invalidFiles.push(l):o.acceptablefiles.push(...k(l,this.multipleFiles))}if(!function(e,t,n,i,o){if(e.length>0){let e,s=n.concat(i),r="The file(s) must end in ";s.length>1&&(s[s.length-1]="or "+s[s.length-1]),e=s.length>2?s.join('," "'):s.join('" "');let l=t.filter((e,n)=>t.indexOf(e)===n).map(e=>'"'+e+'"');return e=e.replace(/"or /g,'or "'),r+='"'+e+'." Your file(s) end in '+l.join(", "),o.onError({title:"Invalid File Extension!",body:r}),!1}return!0}(o.invalidFiles,t,n,i,this))return!1;if(o.convertNeeded.length>0&&this.onStartConvertFiles(o.convertNeeded),o.acceptablefiles.length>0){let e=()=>{if(o.acceptablefiles.length>0){let t=o.acceptablefiles.pop();this.onFileReady(t),setTimeout(e,100)}};e()}return!0}function k(e,t){let n=[];for(let t in e.mol.frames)n.push({filename:e.filename,mol:e.mol.frameToMol(parseInt(t))});if(n.length>1)for(let e=0;e<n.length;e++)n[e].filename=n[e].filename+".model"+(e+1).toString()+".pdb";return t?n.reverse():n=n.slice(0,1),n}var P=function(e,t,n,i){return new(n||(n=Promise))((function(o,s){function r(e){try{a(i.next(e))}catch(e){s(e)}}function l(e){try{a(i.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}a((i=i.apply(e,t||[])).next())}))};class E{constructor(){this.data=()=>({}),this.methods={},this.props={},this.computed={},this.mounted=function(){},this.defaultPlaceHolder=""}setup(){let e=this,t=Object.assign(Object.assign(Object.assign({},this.props),b),{filenameToShow:{type:String,default:""}}),n=Object.assign(Object.assign({},this.methods),{onFileReady(e){void 0!==e.mol&&(this.$emit("onFileReady",e),this.clearEntryAfterLoad())},onFilesLoaded:w,onError(e){this.$emit("onError",e)},onStartConvertFiles(e){if(0===e.length)return;let t=()=>P(this,void 0,void 0,(function*(){if(e.length>0){let n=e.shift();new Promise((e,t)=>{n.onConvertDone=e,n.onConvertCancel=t,this.$emit("onStartConvertFile",n)}).then(e=>{w.bind(this)([e]),alert("This needs to also only run after corresponding onFileReady runs."),t()}).catch(e=>{this.$emit("onError",{title:"Convert Error",body:e.toString()}),t()})}}));t()},clearEntryAfterLoad:this.clearEntryAfterLoad}),i=Object.assign(Object.assign({},this.computed),{placeholder(){return-1===[void 0,""].indexOf(this.filenameToShow)?this.filenameToShow:this.defaultPlaceHolder}});return Vue.component(this.tag,{data:function(){let t=e.data();return t.defaultPlaceHolder=e.defaultPlaceHolder,t},methods:n,template:this.template,props:t,computed:i,mounted:this.mounted}),this}create(e=0){let t=`<${this.tag}\n            ref="fileLoaderPlugin${e}"\n            :accept="accept" :convert="convert"\n            @onFileReady="onFileReady"\n            @onError="onError"\n            @onStartConvertFile="onStartConvertFile"\n            :valid="valid"\n            :filenameToShow="filenameToShow"\n            :multipleFiles="multipleFiles"\n        >`;return t+=`</${this.tag}>`,t}}class _ extends E{constructor(){super(...arguments),this.tag="file-loader-input",this.tabName="File",this.defaultPlaceHolder="Choose a file or drop it here...",this.clearEntryAfterLoad=function(){},this.template='\n        <div>\n            <b-form-file\n                ref="fileInput"\n                v-model="val"\n                :state="valid"\n                :placeholder="placeholder"\n                drop-placeholder="Drop file here..."\n                :class="id"\n                :required="required"\n                :file-name-formatter="formatFileNames"\n                :multiple="true"\n            ></b-form-file>\n        </div>',this.data=function(){return{files:null}},this.methods=T,this.props=Object.assign({},b),this.computed=F,this.mounted=O}}let C={onStartConvertFile:function(e){this.$emit("onStartConvertFile",e)},onError:function(e){this.$emit("onError",e)},onFileReady:function(e){this.$set(this.value,e.filename,e.mol),this.$emit("input",this.value),this.$emit("onSelectedFilenameChange",e.filename)}},L={};function $(){}let R=Object.assign(Object.assign(Object.assign({},g),b),{label:String,description:String,invalidMsg:{type:String,default:"This field is required!"},selectedFilename:{type:String,default:""},value:{type:Object,default:{}},fileLoaderPlugins:{type:Array,default:["pdb-id-input","file-loader-input"]}});class N extends E{constructor(){super(...arguments),this.tag="pdb-id-input",this.tabName="PDB",this.defaultPlaceHolder="Type your four-character PDB ID here...",this.clearEntryAfterLoad=function(){this.val=""},this.template='\n        <file-loader-text-input\n            v-model="val"\n            ref="textInput"\n            :placeholder="placeholder"\n            :formatter="formatter"\n            @onLoad="loadPdb"\n            :btnDisabledFunc="btnDisabledFunc"\n            :valid="valid"\n        >\n        </file-loader-text-input>',this.data=function(){return{val:""}},this.methods={loadPdb(e){c(`https://files.rcsb.org/view/${e.toUpperCase()}.pdb`,this).then(e=>{})},formatter:e=>e=(e=e.toUpperCase()).slice(0,4),btnDisabledFunc:e=>4!==e.length},this.props=Object.assign({},b)}}class M extends E{constructor(){super(...arguments),this.tag="url-input",this.tabName="URL",this.defaultPlaceHolder="Type your URL here...",this.clearEntryAfterLoad=function(){this.val=""},this.template='\n        <file-loader-text-input\n            v-model="val"\n            ref="textInput"\n            :placeholder="placeholder"\n            @onLoad="loadUrl"\n            :valid="valid"\n        >\n        </file-loader-text-input>',this.data=function(){return{val:""}},this.methods={loadUrl(e){c(e,this).then(e=>{})}},this.props=Object.assign({},b)}}class D extends E{constructor(){super(...arguments),this.tag="alphafold-input",this.tabName="AF",this.defaultPlaceHolder="AlphaFold: Type the UniProt accession...",this.clearEntryAfterLoad=function(){this.val=""},this.template='\n        <file-loader-text-input\n            v-model="val"\n            ref="textInput"\n            :placeholder="placeholder"\n            :formatter="formatter"\n            @onLoad="loadAlphaFold"\n            :btnDisabledFunc="btnDisabledFunc"\n            :valid="valid"\n        >\n        </file-loader-text-input>',this.data=function(){return{val:""}},this.methods={loadAlphaFold(e){let t="https://alphafold.ebi.ac.uk/api/prediction/"+e.toUpperCase();fetch(t).then(e=>e.json()).then(e=>{let t=e[0].pdbUrl;t&&c(t,this).then(e=>{})}).catch(e=>{e.message="Error loading data. Is your UniProt accession correct?",m(e,t,this)})},formatter:e=>e=(e=(e=e.toUpperCase()).replace(/[^A-Z0-9]/g,"")).slice(0,10),btnDisabledFunc:e=>!e.match(/[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}/)},this.props=Object.assign({},b)}}let I=[],V=()=>{switch(I.length){case 0:return"";case 1:return I[0].create();default:let e='<span v-if="fileLoaderPlugins.length > 1">\n                <b-tabs>',t=1;for(let n of I)e+=`\n                    <b-tab \n                        v-if="fileLoaderPlugins.indexOf('${n.tag}') !== -1"\n                        v-model="tabIndex" \n                        key="${n.tabName}" \n                        style="margin-top:-1px;" \n                        title="${n.tabName}"\n                    >\n                        ${n.create(t)}\n                    </b-tab>`,t++;e+="</b-tabs>\n                </span>\n                <span v-else>",t=1;for(let n of I)e+=`\n                    <div\n                        v-if="fileLoaderPlugins.indexOf('${n.tag}') !== -1"\n                        key="${n.tabName}" \n                    >\n                        ${n.create(t)}\n                    </div>`,t++;return e+="</span>",e}},j={isValid(){let e=!1===this.required||0!==Object.keys(this.value).length;return e?null:e},filenameToShow(){return!0===this.multipleFiles?"":this.selectedFilename}};function B(){!function(e){I=e,void 0===I&&(I=[(new _).setup()]);Vue.component("file-loader-text-input",{data:()=>({localValue:""}),methods:{onLoad(){this.$emit("onLoad",this.value)},keydown(e){"Enter"===e.key&&this.onLoad()},keyup(e){this.$emit("input",this.localValue)}},template:'\n            <b-input-group>\n                <b-form-input \n                    v-model="localValue"\n                    style="border-top-left-radius:4px; border-bottom-left-radius:4px;"\n                    :placeholder="placeholder"\n                    :formatter="formatter"\n                    @keydown="keydown"\n                    @keyup="keyup"\n                    :state="valid"\n                ></b-form-input>\n                <b-input-group-append>\n                    <b-button \n                        style="background-color:#e9ecef; color:#4a5056; border:1px solid #ced4da; border-top-right-radius:4px; border-bottom-right-radius:4px;"\n                        variant="outline-primary"\n                        @click="onLoad"\n                        :disabled="btnDisabledFunc(value)"\n                    >\n                        Load\n                    </b-button>\n                </b-input-group-append>\n            </b-input-group>',props:{placeholder:{type:String,default:"Type here..."},formatter:{type:Function,default:e=>e},btnDisabledFunc:{type:Function,default:()=>!1},valid:{type:Boolean,default:!0},value:{type:String,default:""}},computed:{},mounted:()=>{}}),Vue.component("file-loader",{data:()=>({tabIndex:0}),methods:Object.assign(Object.assign({},L),C),template:`\n            <span>\n                <file-loader-form-group\n                    :label="label"\n                    :id="'input-group-' + id"\n                    :description="description"\n                    styl="line-height:0;"\n                >\n                    <template v-slot:extraDescription>\n                        <slot name="extraDescription"></slot>\n                    </template>\n\n                    ${V()}\n\n                    <small \n                        v-if="isValid === false" \n                        alert tabindex="-1" \n                        class="text-danger form-text"\n                    >{{invalidMsg}}</small>\n                </file-loader-form-group>\n            </span>\n        `,props:R,computed:j,mounted:$})}([(new _).setup(),(new N).setup(),(new D).setup(),(new M).setup()])}let H={currentMol(){return this.value[this.selectedFilename]},chainsList(){let e=this.currentMol;return void 0===e?[]:e.getChains()},hasHydrogens(){let e=this.currentMol;return void 0!==e&&e.hasHydrogens()},nonProteinResiduesData(){let e=this.currentMol;if(void 0===e)return{};let t={},n=e.getNonProteinMol();for(let e of n.frames)for(let n of e.atoms)t[n.resn]=new Set([]);for(let e of n.frames)for(let n of e.atoms){let e=n.resn;e+=":"+n.resi,e+=":"+n.chain,t[n.resn].add(e)}return t},removeResiduesSelections(){let e=this.nonProteinResiduesData,t=this.chainsList,n=Object.keys(e);n.sort();let i=[],o=[];for(let t of n)if(e[t].size>10)i.push({resnames:[t],nonProtein:!0});else{let n=[];e[t].forEach(e=>{n.push(e)}),n.sort((e,t)=>e.resname<t.resname?-1:e.resname>t.resname?1:0);for(let e of n){let t=e.split(":");o.push({resnames:[t[0]],resids:[t[1]],chains:[t[2]],nonProtein:!0})}}let s=[];if(t.length>1)for(let e of t)s.push({chains:[e],nonProtein:!1});return[...i,...o,...s]}};function U(e){if(e.chains&&!e.resnames&&!e.resids)return"Chain: "+e.chains;let t=[];return e.resnames&&t.push(e.resnames),e.resids&&t.push(e.resids),e.chains&&t.push(e.chains),t.join(":")}function W(e){let t=this.value[this.selectedFilename],[n,i]=t.partitionBySelection(e);return this.$set(this.value,this.selectedFilename,i),this.$emit("input",this.value),n}function q(e){let t=W.bind(this)(e),n=this.selectedFilename,i=d(n),o=function(e,t=!0){let n=d(e,t);return e.substring(0,e.length-n.length-1)}(n)+"-"+f(U(e)).toUpperCase()+"."+i;this.$emit("onExtractAtoms",{selection:e,pdbLines:t,origFilename:n,suggestedNewFilename:o})}let G={onExtractAtoms(e){this.$emit("onExtractAtoms",e)},keepNonProteinResidueSelections:e=>e.filter(e=>!0===e.nonProtein),deleteAllNonProteinResidues(e){e=this.keepNonProteinResidueSelections(e);let t=this.value[this.selectedFilename];for(let n of e)t=t.deleteSelection(n);this.$set(this.value,this.selectedFilename,t),this.$emit("input",this.value)},deleteHydrogens(){this.deleteOrExtractResidues({elems:["H"]})},deleteOrExtractResidues(e){"delete"===this.editAction?W.bind(this)(e):q.bind(this)(e)},selDesc:e=>U(e)};function z(){this.editAction=this.allowAtomDelete?"delete":"extract",p("#select-action-btns .btn { padding:0; line-height:1.4; }")}let Y={fileDismissed(e){let t=Object.keys(this.value),n=t.indexOf(e),i=t[0===n?n+1:n-1];this.fileNameClicked(i),this.$delete(this.value,e),this.$emit("input",this.value),this.$emit("onSelectedFilenameChange",i)},clearAll(){this.$emit("input",{}),this.$emit("onSelectedFilenameChange","")},fileNameClicked(e){this.currentlySelectedFilenameToUse=e,this.$nextTick(()=>{this.$emit("onSelectedFilenameChange",e)})},scrollToBottom(){setTimeout(()=>{let e=this.$refs.filesDiv;e.scrollTo({top:e.clientHeight,left:0,behavior:"smooth"})},500)}},Z={filenames(){return Object.keys(this.value)}};function X(){p(".alert-dismissible { padding: 0.15rem !important;} .alert-dismissible .close {padding-top: 1px; padding-right: 8px; padding-left: 8px; padding-bottom: 0;}")}let J={};let Q={currentPdbFile(){return{filename:this.selectedFilename,mol:this.files[this.selectedFilename]}},idToUse(){return f(this.label?this.label:this.description)}},K={onSelectedFilenameChange(e){this.selectedFilename=e},onError(e){this.$emit("onError",e)},onExtractAtoms(e){this.$emit("onExtractAtoms",e)},onStartConvertFile(e){this.$emit("onStartConvertFile",e)},loadMolFromExternal(e,t){this.$refs.fileLoader.$refs.fileLoaderPlugin1.onFilesLoaded([{filename:e,mol:l(e,t)}])}};function ee(){}function te(){Vue.component("file-loader-form-group",{data:function(){return{}},computed:h,template:'\n            <span class="file-loader-form-group">\n                <b-form-group\n                    v-if="formGroupWrapper"\n                    :label="label"\n                    :label-for="id"\n                    :id="\'input-group-\' + id"\n                    :style="styl + \';max-width:none !important;\'"\n                    :label-cols="label ? 12 : 0"\n                    :label-cols-sm="label ? 2 : 0"\n                >\n                    <slot></slot>\n                    <small\n                        tabindex="-1"\n                        :id="\'input-group-input-group-\' + id + \'__BV_description_\'"\n                        class="form-text text-muted" style="display:inline;"\n                        v-html="description">\n                    </small>\n                    <small class="form-text text-muted" style="display:inline;">\n                        <slot name="extraDescription"></slot>\n                    </small>\n                </b-form-group>\n                <div v-else>\n                    <slot></slot>\n                </div>\n            </span>\n        ',props:{label:{type:String,default:void 0},id:String,styl:String,description:String,formGroupWrapper:{type:Boolean,default:!0},labelToLeft:{type:Boolean,default:!0}},methods:{},mounted(){p(".file-loader-form-group .col-form-label { hyphens: auto; }")}}),B(),Vue.component("file-list",{data:()=>({currentlySelectedFilenameToUse:""}),watch:{selectedFilename(e,t){this.fileNameClicked(e)}},methods:Y,template:'\n            <div>\n                <div \n                    ref="filesDiv" \n                    style="max-height:135px; overflow-y:scroll;" \n                    :class="filenames.length > 0 ? \'mt-2\' : \'\'"\n                >\n                    <b-alert \n                        v-for="filename in filenames"\n                        :key="filename"\n                        class="mb-1 p-3 py-3"\n                        dismissible\n                        fade\n                        show\n                        :variant="(filename === currentlySelectedFilenameToUse) ? \'primary\' : \'secondary\'"\n                        @dismissed="fileDismissed(filename)"\n                    >\n                        <div style="cursor:pointer; position:relative; top:0px; left:4px;" @click="fileNameClicked(filename)">\n                            <div style="display:inline; position:relative: top:2px;">&#128206; &nbsp;</div> {{filename}}\n                        </div>\n                    </b-alert>\n                </div>\n                <div \n                    v-if="filenames.length > 1"\n                    style="height:22.5px;"\n                >\n                    <b-form-tag\n                        style="padding-top:3px; cursor:pointer; position:relative; top:1px; float:right;"\n                        :no-remove="true"\n                        :pill="true"\n                        @click.native="clearAll"\n                    >Clear All</b-form-tag>\n                </div>\n            </div>\n        ',props:{selectedFilename:{type:String,default:""},id:{type:String,default:void 0},value:{type:Object,default:{}}},computed:Z,mounted:X}),Vue.component("protein-editing",{data:()=>({localValue:{},editAction:"delete",editActions:[{html:"&#10006;&nbsp; Delete",value:"delete"},{html:'<span style="display:inline-block; transform: scaleX(-1);">&#10138; </span>&nbsp; Extract',value:"extract"}]}),watch:{value(e,t){this.localValue=e},localValue(e,t){this.$emit("input",e)}},methods:G,template:'\n            <span v-if="(removeResiduesSelections.length > 0) && (allowAtomExtract || allowAtomDelete)">\n                <b-alert class="mt-2 mb-0" show variant="warning">\n                    <b-form-group v-if="allowAtomExtract && allowAtomDelete">\n                        \x3c!-- :aria-describedby="ariaDescribedby" --\x3e\n                        <b-form-radio-group\n                            class="d-flex flex-wrap"\n                            style="margin-bottom:-12px; padding:0px;"\n                            id="select-action-btns"\n                            v-model="editAction"\n                            :options="editActions"\n                            name="select-action-btns"\n                            buttons\n                            size="sm"\n                            button-variant="outline-secondary"\n                        ></b-form-radio-group>\n                    </b-form-group>\n                    <span v-else>\n                        <span v-if="allowAtomDelete">Delete:</span>\n                        <span v-if="allowAtomExtract">Extract:</span>\n                    </span>\n                    <small-pill-btn \n                        v-if="keepNonProteinResidueSelections(removeResiduesSelections).length > 0"\n                        :actionStyling="editAction" \n                        @click="deleteAllNonProteinResidues(removeResiduesSelections)">\n                        All Non-Protein\n                    </small-pill-btn><small-pill-btn v-if="hasHydrogens && editAction === \'delete\'" :actionStyling="editAction" @click="deleteHydrogens()">\n                        Hydrogens\n                    </small-pill-btn><small-pill-btn \n                        :actionStyling="editAction"\n                        v-for="result, i of removeResiduesSelections" \n                        :key="i"\n                        @click="deleteOrExtractResidues(result)"\n                    >{{selDesc(result)}}</small-pill-btn>\n                </b-alert>\n            </span>\n        ',props:Object.assign({selectedFilename:{type:String,default:""},value:{type:Object,default:{}}},v),computed:H,mounted:z}),Vue.component("queue-controller",{data:()=>({active:!1,numItemsInQueue:-1}),watch:{trigger(e,t){this.onProceed()}},methods:{onProceed(){Object(S.d)(this.molLoaderIds).then(e=>{let t={};this.molLoaderIds.forEach((n,i)=>{let o=e[i];o.mol=l(o.filename,o.mol),t[n]=o}),this.$emit("onQueueDelivery",t)})},onStop(){Object(S.a)(this.outputZipFilename)}},template:'\n            <queue-timer\n                v-if="active"\n                :countDownSeconds="countDownSeconds"\n                :numItemsInQueue="numItemsInQueue"\n                @onProceed="onProceed"\n                @onStop="onStop"\n            >\n            </queue-timer>\n            <div v-else>\n                <slot></slot>\n            </div>\n        ',props:Object.assign({},y),computed:x,mounted:A}),Vue.component("small-pill-btn",{data:function(){return{}},computed:J,template:'\n            <b-button \n                pill :variant="actionStyling === \'delete\' ? \'secondary\' : \'outline-secondary\'" size="sm" \n                class="py-0 px-1"\n                style="line-height:14px; font-size:90%; margin-right:2px;"\n                @click="onClick"\n            >\n                <span\n                    v-if="actionStyling === \'extract\'"\n                    style="display:inline-block; transform: scaleX(-1);">&#10138;\n                </span>\n                <span v-else>&#10006;</span>\n                <slot></slot>\n            </b-button>\n            \x3c!-- style="line-height:14px; font-size:80%;" --\x3e\n        ',props:{actionStyling:{type:String,default:"delete"}},methods:{onClick(){this.$emit("click")}},mounted(){}}),Vue.component("mol-loader",{data:()=>({selectedFilename:"",files:{}}),methods:K,template:'\n            <div>\n                <file-loader\n                    ref="fileLoader"\n                    v-model="files"\n                    :label="label"\n                    :id="idToUse"\n                    :description="description"\n                    :accept="accept"\n                    :convert="convert"\n                    :required="required"\n\n                    :fileLoaderPlugins="fileLoaderPlugins"\n\n                    @onSelectedFilenameChange="onSelectedFilenameChange"\n                    :selectedFilename="selectedFilename"\n\n                    @onError="onError"\n                    @onStartConvertFile="onStartConvertFile"\n                    :multipleFiles="multipleFiles"\n                >\n                    <template v-slot:extraDescription>\n                        {{extraDescription}}\n                        <file-list\n                            v-if="multipleFiles"\n                            v-model="files"\n                            :selectedFilename="selectedFilename"\n                            @onSelectedFilenameChange="onSelectedFilenameChange"\n                        ></file-list>\n        \n                        <protein-editing\n                            v-if="allowAtomDelete || allowAtomExtract"\n                            v-model="files"\n                            :selectedFilename="selectedFilename"\n                            :allowAtomExtract="allowAtomExtract"\n                            :allowAtomDelete="allowAtomDelete"\n                            @onSelectedFilenameChange="onSelectedFilenameChange"\n                            @onExtractAtoms="onExtractAtoms"\n                        ></protein-editing>\n                    </template>\n                </file-loader>\n            </div>\n        ',props:Object.assign(Object.assign(Object.assign({},g),v),{label:{type:String,default:void 0},description:{type:String,default:"Primary description goes here."},extraDescription:{type:String,default:"Some extra description goes here."},accept:{type:String,default:".pdb"},convert:{type:String,default:""},required:{type:Boolean,default:!0},fileLoaderPlugins:{type:Array,default:["pdb-id-input","file-loader-input"]}}),computed:Q,watch:{currentPdbFile(e,t){this.$emit("onFileReady",e)},files(e,t){!1!==this.saveMultipleFilesToDatabase&&Object(S.b)(this.idToUse,e)}},mounted:ee})}},qx2k:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));let i={val:{get(){return this.$store.state.fpocketParams[this.id]},set(e){e=""===e?void 0:+e,isNaN(e)&&(e=void 0),this.$store.commit("setFpocketParam",{name:this.id,val:e});let t=!0,n=this.$store.state.fpocketParams.score_only;!0===this.required&&!0!==n&&(this.invalidMsg="This field is required.",t=void 0!==e),!0===t&&void 0!==this.min&&this.min>e&&(this.invalidMsg="Value must be &ge; "+this.min.toString()+".",t=!1),!0===t&&void 0!==this.max&&this.max<e&&(this.invalidMsg="Value must be &le; "+this.max.toString()+".",t=!1),this.$store.commit("setValidationParam",{name:this.id,val:t})}},desc(){let e="";return!0!==this.required&&void 0===this.default&&(e=" (Leave blank to use default value.)"),this.description+e},isValid(){return this.$store.state.validation[this.id]}};function o(){void 0===this.$store.state.validation[this.id]&&this.$store.commit("setValidationParam",{name:this.id,val:!this.required}),void 0!==this.default&&this.$store.commit("setFpocketParam",{name:this.id,val:this.default})}function s(){Vue.component("numeric-input",{data:function(){return{invalidMsg:"This field is required."}},computed:i,template:'\n            <form-group\n                :label="label"\n                :id="\'input-group-\' + id"\n                :style="styl"\n                :description="desc"\n                :formGroupWrapper="formGroupWrapper"\n            >\n                <b-form-input\n                    :id="id"\n                    :name="id"\n                    v-model="val"\n                    type="number"\n                    :required="required"\n                    :placeholder="placeholder"\n                    :class="{ \'is-invalid\': !isValid }"\n                    :min="min" :max="max"\n                    :step="step"\n                ></b-form-input>\n                <small v-if="!isValid" alert tabindex="-1" class="text-danger form-text" v-html="invalidMsg"></small>\n            </form-group>\n        ',props:{label:String,id:String,description:String,placeholder:String,required:Boolean,styl:String,default:Number,formGroupWrapper:{type:Boolean,default:!0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},step:{type:Number,default:void 0}},mounted:o})}},"y/mi":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));let i={modalShow:{get(){return this.$store.state.modalShow},set(e){this.$store.commit("setVar",{name:"modalShow",val:e})}},title(){return this.$store.state.modalTitle},body(){return this.$store.state.modalBody}};function o(){Vue.component("open-modal",{data:function(){return{}},computed:i,template:'\n            <b-modal ok-only :size="size" ok-title="Close" v-model="modalShow" id="msg-modal" :title="title">\n                <p class="my-4" v-html="body"><slot></slot></p>\n            </b-modal>\n        ',props:{size:{type:String,default:"lg"}}})}}}]);